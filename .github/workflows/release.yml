name: Release

# Evento que dispara o workflow
on:
  push:
    branches:
      - main           # Executa quando houver push na branch main
    tags:
      - 'v*.*.*'       # Executa tambÃ©m quando uma tag que segue o padrÃ£o de versÃ£o for criada (ex: v1.0.0)

jobs:
  release:
    name: Changelog & GitHub Release
    runs-on: ubuntu-latest  # Ambiente que executa a job

    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4   # Faz checkout do cÃ³digo da branch/tag atual

      - name: ğŸ§ª Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18          # Define a versÃ£o do Node.js para rodar os comandos

      - name: ğŸ“¦ Install dependencies
        run: npm ci                # Instala as dependÃªncias de forma limpa e rÃ¡pida

      - name: ğŸš€ Run standard-version to bump version and generate changelog
        run: npx standard-version  # Executa o standard-version para atualizar versÃ£o e gerar changelog

      - name: ğŸ”¥ Push changes and tags
        run: |
          git push --follow-tags origin main  # Envia os commits e tags gerados para o GitHub

      - name: ğŸ·ï¸ Create GitHub release
        uses: ncipollo/release-action@v1     # Cria uma release no GitHub automaticamente
        with:
          tag: ${{ github.ref_name }}        # Usa a tag que disparou o workflow para a release
